<!DOCTYPE html PUBLIC "Uncompressed source: https://github.com/rmurphey"><html id="rmurphey-com"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Remixing trac with jQuery</title><meta name="description" content="Remixing trac with jQuery"/><meta name="HandheldFriendly" content="True"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="twitter:description" content="I love trac, and I&#39;ve been doing lots of work lately to customize it so our clients can use it to send us requests. With the configurable workflow option offered in version 0.11, it became the perfect way for us to manage and track client requests. By connecting it to the subversion repository we use for version control of client files, we&#39;ve virtually eliminated the need for back-and-forth emails -- everything is in one place.
Since trac is intended more for managing a development project than for managing an ongoing client relationship, I&#39;ve had to make some changes to the out-of-the-box version. I don&#39;t know Python, and I was having a hard time getting a developer to dive in at the level I needed on a non-billable project. Lucky for me, version 0.11 also includes jQuery (version 1.1.3.1). After a couple of chats with a developer and a few &quot;duh&quot; moments, it became clear that I could do most of what I needed without messing around under the hood.
The story so far:

Our clients use trac for internal approval of a request before it gets sent to us -- a content provider can enter a request, which then gets reviewed by a manager. We needed a way to assign this manager to the ticket, without the manager becoming the &quot;owner&quot; of the ticket. Initially, we had content providers entering their manager&#39;s email address into the Cc: field, but that didn&#39;t go over well. Now, jQuery reuses the existing Assign to menu to build a manager dropdown, with the usernames of our employees removed. When the ticket is submitted, the manager is added to the Cc: field automatically.

{% codeblock lang:javascript %}
// build the new dropdown
var custom_cc_select = &#39;&#39;;
$(&#39;#custom-form&#39;).append(custom_cc_select);
$(&#39;#field-owner option&#39;).each(function() {
  var name = $(this).html();
  if ($.inArray(name,excludedManagers) == -1) {
    $(&#39;#custom-cc&#39;).append(&#39;&#39; + name + &#39;&#39;);
  }
});

// add the selected manager to the cc field on ticket submit
$(&#39;div.ticket form&#39;).submit(function() {
  var oldCc = $(&#39;#field-cc&#39;).val();
  var manager = $(&#39;#custom-cc option:selected&#39;).html();
  if (oldCc != &#39;&#39;) { $(&#39;#field-cc&#39;).val(oldCC + &#39;, &#39; + manager); }
  else { $(&#39;#field-cc&#39;).val(manager); }
});
{% endcodeblock %}



The standard trac ticket fields were exactly what we needed, but the labels for them were a little confusing to client users. Plus, the form was ugly. A few lines of jQuery created a new section in the form, moved the fields to that section without their table-based layout, reordered the fields and and relabeled them. For example:

{% codeblock lang:javascript %}
$(&#39;#field-component&#39;). // get the component dropdown
remove(). // remove it from the DOM but maintain access to it
appendTo(&#39;#custom-form&#39;). // put it at the end of the #custom-form div
before(&#39;Request Type&#39;); // put a new label before it
{% endcodeblock %}

The new form makes more sense to the client users, reduces errors and omissions, and looks better too.

For certain client requests, a more complex form is required. Trac offers custom fields, but that solution seemed too limiting. With a few more lines of jQuery, I set up a system that watches the Component dropdown. When certain components are chosen, the standard submission form is hidden, and a new form is put in its place using jQuery&#39;s load() method. The replacement content can include HTML, standard form elements and javascript; when the form is submitted, javascript assembles the field values into a well-formatted description.
"><meta name="twitter:creator" content="@rem"/><meta name="twitter:title" content="Remixing trac with jQuery"/><meta name="twitter:site" content="@rem"/><meta name="twitter:domain" content="Remy's b:log"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/favicon.ico"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic,300,800|Source+Code+Pro:400,700,300" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/default.min.css"/><style>@media (max-width: 800px) {
  body {
    margin: 5%;
  }
}

@media (min-width: 800px) {
  body {
    margin: 5% 20%;
    font-size: 120%;
  }
}

body {
  font-family: "Open Sans";
  font-weight: 300;
}

p, li {
  line-height: 1.8em;
}

em {
  font-style: italic;
}

strong {
  font-weight: 700;
}

a:hover {
  color: #fb6b70;
}

a:visited {
  color: #9a3337;
}

a {
  color: #d9272e;
  text-decoration: none;
}

pre, code {
  font-family: "Source Code Pro", monospace;
  font-weight: 400;
}

pre strong, code strong {
  font-weight: 700;
}

h1.banner {
  font-size: 220%;
}

h1.banner span {
  font-weight: 300;
}

.search input[type=submit] {
  margin-left: 1em;
}
</style><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-143877-10', 'auto');
ga('send', 'pageview');</script></head><body id="blog-remixing-trac-with-jquery-page"><h1 class="banner title">rmurphey&nbsp;<span>adventures in javascript</span></h1><nav class="main-nav clearfix subpanel"><form action="https://google.com/search" class="search"><input type="hidden" name="q" value="site:rmurphey.com"/><input type="text" name="q" placeholder="Search for..."/><input type="submit" value="Search"/></form><ul class="post-nav"><li class="home"><a href="/">Home</a></li><li class="next"><a href="/blog/2007/12/04/getting-non-developers-on-the-subversion-bandwagon" title="Getting non-developers on the subversion bandwagon">Next</a></li><li class="prev"><a href="/blog/2007/12/03/my-case-for-standards-based-web-layouts" title="My case for standards-based web layouts">Previous</a></li></ul></nav><main role="main" class="content"><article class="post"><h1 class="title"><a href="/2007/12/03/remixing-trac-with-jquery" rel="bookmark" title="Permanent Link: Remixing trac with jQuery">Remixing trac with jQuery</a></h1><div class="post-content"><p>I love <a href="http://trac.edgewall.org/">trac</a>, and I&#39;ve been doing lots of work lately to customize it so our clients can use it to send us requests. With the configurable workflow option offered in <a href="http://trac.edgewall.org/milestone/0.11">version 0.11</a>, it became the perfect way for us to manage and track client requests. By connecting it to the subversion repository we use for version control of client files, we&#39;ve virtually eliminated the need for back-and-forth emails -- everything is in one place.</p>
<p>Since trac is intended more for managing a development project than for managing an ongoing client relationship, I&#39;ve had to make some changes to the out-of-the-box version. I don&#39;t know Python, and I was having a hard time getting a developer to dive in at the level I needed on a non-billable project. Lucky for me, version 0.11 also includes jQuery (version 1.1.3.1). After a couple of chats with a developer and a few &quot;duh&quot; moments, it became clear that I could do most of what I needed without messing around under the hood.</p>
<p>The story so far:</p>
<ul>
<li>Our clients use trac for internal approval of a request before it gets sent to us -- a content provider can enter a request, which then gets reviewed by a manager. We needed a way to assign this manager to the ticket, without the manager becoming the &quot;owner&quot; of the ticket. Initially, we had content providers entering their manager&#39;s email address into the Cc: field, but that didn&#39;t go over well. Now, jQuery reuses the existing Assign to menu to build a manager dropdown, with the usernames of our employees removed. When the ticket is submitted, the manager is added to the Cc: field automatically.

{% codeblock lang:javascript %}
// build the new dropdown
var custom_cc_select = &#39;&#39;;
$(&#39;#custom-form&#39;).append(custom_cc_select);
$(&#39;#field-owner option&#39;).each(function() {
  var name = $(this).html();
  if ($.inArray(name,excludedManagers) == -1) {
    $(&#39;#custom-cc&#39;).append(&#39;&#39; + name + &#39;&#39;);
  }
});

// add the selected manager to the cc field on ticket submit
$(&#39;div.ticket form&#39;).submit(function() {
  var oldCc = $(&#39;#field-cc&#39;).val();
  var manager = $(&#39;#custom-cc option:selected&#39;).html();
  if (oldCc != &#39;&#39;) { $(&#39;#field-cc&#39;).val(oldCC + &#39;, &#39; + manager); }
  else { $(&#39;#field-cc&#39;).val(manager); }
});
{% endcodeblock %}

</li>

<li>The standard trac ticket fields were exactly what we needed, but the labels for them were a little confusing to client users. Plus, the form was ugly. A few lines of jQuery created a new section in the form, moved the fields to that section without their table-based layout, reordered the fields and and relabeled them. For example:

{% codeblock lang:javascript %}
$(&#39;#field-component&#39;). // get the component dropdown
remove(). // remove it from the DOM but maintain access to it
appendTo(&#39;#custom-form&#39;). // put it at the end of the #custom-form div
before(&#39;Request Type&#39;); // put a new label before it
{% endcodeblock %}

The new form makes more sense to the client users, reduces errors and omissions, and looks better too.</li>

<li>For certain client requests, a more complex form is required. Trac offers custom fields, but that solution seemed too limiting. With a few more lines of jQuery, I set up a system that watches the Component dropdown. When certain components are chosen, the standard submission form is hidden, and a new form is put in its place using jQuery&#39;s load() method. The replacement content can include HTML, standard form elements and javascript; when the form is submitted, javascript assembles the field values into a well-formatted description.</li>
</ul><p class="follow">Posted 3-Dec 2007.</p></div><div class="comments"><h2>Comments</h2><div id="disqus_thread"></div><script>var disqus_shortname = 'rmurphey';
var disqus_url = 'http://rmurphey.com/2007/12/03/remixing-trac-with-jquery/';
var disqus_title = 'Remixing trac with jQuery';</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></a></div></article></main><footer class="site-footer clearfix flex subpanel"><div class="flex-item archives"><h2>Archives</h2><ul><li><a href="/archives">All years</a></li><li><a href="/2015">2015</a></li><li><a href="/2014">2014</a></li><li><a href="/2013">2013</a></li><li><a href="/2012">2012</a></li><li><a href="/2011">2011</a></li><li><a href="/2010">2010</a></li><li><a href="/2009">2009</a></li><li><a href="/2008">2008</a></li><li><a href="/2007">2007</a></li></ul></div><div class="flex-item links"><h2>Links</h2><ul><li><a href="/about.html">About</a></li><li><a target="_blank" href="/feed.xml">RSS feed</a></li><li><a target="_blank" href="https://github.com/rmurphey">On GitHub</a></li><li><a target="_blank" href="https://twitter.com/rmurphey">On Twitter</a></li></ul></div><div class="flex-item license"><h2>License</h2><p class="vcard">Copyright © 2015 <a class="url fn" href="http://rmurphey.com">Rebecca Murphey</a>.</p><p>All code and content for this blog is available <a href="https://github.com/rmurphey">on GitHub</a>.</p>
</div><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><!--|  
|  
|  Carved up by hand using Harp and a shit load of hacking ❤
|  
|  Also, this:
|  
|  
|  
|                        \_            /;              _.._
|                        `\~--.._     //'            ,(+=\\\\
|                         `//////\  \\/;'             /~ (\\\\
|                           ~/////\~\`)'             /;   ))))
|                               `~'  |              ((`~/((((\
|                               ;'_\'\             /'))   )))))
|                              /~/ '" "'     _.  /'/\_ /^\`((( \
|                             `\/'       _.-~/--/ (  =(   | ,  |
|                                     _/~\_)_}___/^\/~`\.__\|==|
|                                    /uUUU)        )        |  |
|                                   (   / |      _-=o|\__ /'/~ \
|                                   ' /'  |     /(((((\`\(  |~\/
|                                   /'    |   /' )))))"`\`\|/_/---.._,$$,
|                             .,ssS$$$Sss|._/_..-((('    )\)>>>      ~\$
|                          ,sS$$$$$$$$$$$|$$$$$$$  |/    //'~`o        `\
|                        ,$$$$$$$$$$$$$$|$$S$$$$'  (    /                \
|                      ,$$$$$$$$$$$$S$$|$$$$$$$'   |   /              ,s$$$
|                    s$$$$$S$$$$$$$$$S|$$$$$$$$    |  /              $$$$$$
|                  _~,$S""''     ``"S|$$S$$$$$"    (_,`\,          ,$$$$$$$;
|                /~ ,"'             / 'S$$$$$"      \_./|        s$$$$$$$$$$
|             (~'      _,  \==~~)  /     """         \  |       $$$$$$$$$$$$
|              (0\   /0/     \-' /'                   \ |  |  ,$$$$$$$$$$$$$,
|              `/'  '         _-~                     |= \_-\ $$$$$$$$$$$$$$s
|              (~~~)      _.-~_-   \             \  ,s|= |   `"$$$$$$$$$$$$$$$
|             ( `-'  )/>-~  _/-__   |            |,$$$|_/,      `"$$$$$$$$$$$$
|             /V^^^^V~/' _/~/~~  ~~-|            |$$$$$$$$         "$$$$$$$$$$,
|            /  (^^^^),/' /'        )           /S$$$$$$$;         ,$$$$$$$$$$$,
|          ,$$_  `~~~'.,/'         /     _-ss, /(/-(/-(/'        ,s$$$$$$$$$$$$$
|        ,s$$$$$ssSS$$$'         ,$'.s$$$$$$$$'                  (/-(/-(/-(/-(/'
|       S$$$$$$$$$$$$$$        ,$$$$$$$$$$$$$'
|      (/-(/-(/-(/-(/'      _s$$$$$$$$$$$$$$
|                          (/-(/-(/-(/-(/-'
|  
|  
|  
|      – Remy
|  
|  --></footer><!-- Env: production - static files--></body></html>